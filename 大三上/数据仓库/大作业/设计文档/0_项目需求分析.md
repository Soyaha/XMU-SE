# 淘宝用户行为数据仓库 - 项目需求分析文档

## 1. 项目背景与意义
随着电子商务的蓬勃发展，平台积累了海量的用户行为数据。这些数据中蕴含着用户的消费习惯、兴趣偏好以及商品的市场表现等高价值信息。
本项目旨在构建一个基于 Hadoop/Hive 生态系统的离线数据仓库，对淘宝用户的历史行为数据进行清洗、建模和分析。通过挖掘流量趋势、转化漏斗、热门商品等核心指标，为电商运营决策（如精准营销、商品推荐、库存管理）提供数据支持。

## 2. 数据源说明
本项目使用阿里巴巴提供的淘宝用户行为数据集 (`UserBehavior.csv`)。

*   **数据规模**: 约 1 亿条记录（实际作业中使用部分采样数据或全量数据）。
*   **数据格式**: CSV 文本文件，逗号分隔。
*   **字段定义**:
    1.  **User ID**: 用户唯一标识 (整数类型，脱敏)。
    2.  **Item ID**: 商品唯一标识 (整数类型，脱敏)。
    3.  **Category ID**: 商品类目唯一标识 (整数类型，脱敏)。
    4.  **Behavior Type**: 行为类型，包括 `pv` (浏览), `buy` (购买), `cart` (加购), `fav` (收藏)。
    5.  **Timestamp**: 行为发生的时间戳 (秒级)。

## 3. 业务需求分析
根据电商分析的通用框架，本项目需实现以下四大类业务指标的计算与展示：

### 3.1 流量分析 (Traffic Analysis)
*   **日活跃用户数 (DAU)**: 统计每日访问平台的用户数，衡量平台流量规模。
*   **分时流量趋势**: 统计一天中各小时的 PV/UV 分布，识别用户活跃高峰期（如通勤时间、晚间休息时间），指导活动投放时段。
*   **7日/30日活跃用户**: 分析用户的长期粘性。

### 3.2 转化分析 (Conversion Analysis)
*   **用户行为漏斗**: 构建 "浏览 -> 加购/收藏 -> 购买" 的转化路径。
*   **环节转化率**: 计算各环节之间的转化率（如 PV转加购率、加购转购买率），定位用户流失严重的环节。

### 3.3 商品与类目分析 (Item & Category Analysis)
*   **热门商品 Top10**: 按浏览量和销量统计最受欢迎的商品，用于首页推荐或爆款打造。
*   **热门类目 Top10**: 统计流量最大和销量最高的商品类目，了解市场热点趋势。
*   **商品转化率**: 分析高流量但低转化的商品，诊断商品详情页或定价问题。

### 3.4 用户价值分析 (User Value Analysis)
*   **复购率分析**: 统计产生两次及以上购买行为的用户比例，衡量用户忠诚度。
*   **用户活跃度分层**: 根据用户行为频次，识别高价值活跃用户和沉睡用户。

## 4. 功能需求 (Functional Requirements)

### 4.1 数据处理与ETL
*   **数据导入**: 将原始 CSV 文件加载到 Hive ODS 层。
*   **数据清洗**:
    *   过滤异常时间戳（如超出分析时间范围的数据）。
    *   处理缺失值和格式错误。
    *   **时区转换**: 将原始 UTC 时间戳转换为北京时间 (UTC+8)。
*   **维度建模**: 构建用户、商品、时间等维度表。

### 4.2 数据仓库分层建设
遵循标准数仓架构，建设以下四层：
*   **ODS 层**: 保持原始数据原貌，备份数据。
*   **DWD 层**: 结构化明细数据，统一字段命名和格式，采用列式存储。
*   **DWS 层**: 按天、用户、类目等维度进行轻度汇总，减少下游计算量。
*   **ADS 层**: 输出最终业务指标结果，供报表查询。

### 4.3 性能优化
*   **分区策略**: 按日期 (`dt`) 进行分区存储，避免全表扫描。
*   **存储格式**: 使用 ORC 格式存储，提高读取效率。
*   **压缩技术**: 采用 Snappy 压缩，减少磁盘占用和网络传输。
*   **计算优化**: 针对数据倾斜场景（如大促期间的热点商品），采用 Map 端聚合、随机前缀打散等技术优化 SQL。

## 5. 非功能需求 (Non-Functional Requirements)
*   **准确性**: 确保指标计算逻辑正确，与业务定义一致。
*   **稳定性**: ETL 脚本需具备容错能力，支持重跑（幂等性）。
*   **可扩展性**: 数仓架构应支持未来扩展新的数据源或分析指标。
*   **响应速度**: ADS 层查询应在秒级或毫秒级返回结果。

## 6. 技术选型
*   **操作系统**: Linux / Windows (开发环境)。
*   **存储层**: Hadoop HDFS。
*   **计算引擎**: MapReduce (稳定性高) / Spark (速度快)。
*   **数据仓库**: Apache Hive 3.1.2。
*   **开发工具**: VS Code, DataGrip, 或 Hive CLI。
